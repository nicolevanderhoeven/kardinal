version: '3.8'

# Watchtower - Automatic Docker Container Updates
# This service monitors and automatically updates Docker containers
# Usage: docker-compose -f docker-compose.watchtower.yml up -d

services:
  watchtower:
    image: containrrr/watchtower:latest
    container_name: watchtower
    restart: unless-stopped
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      # Only update containers with the watchtower.enable label
      - WATCHTOWER_LABEL_ENABLE=true
      # Check for updates every 6 hours (21600 seconds)
      # Alternative: Use --schedule "0 0 2 * * *" for daily at 2 AM
      - WATCHTOWER_POLL_INTERVAL=21600
      # Clean up old images after updating
      - WATCHTOWER_CLEANUP=true
      # Run in non-root mode (more secure)
      - WATCHTOWER_NO_STARTUP_MESSAGE=false
    command: --label-enable --interval 21600 --cleanup
    # Optional: Add notifications (uncomment and configure if desired)
    # - WATCHTOWER_NOTIFICATIONS=email
    # - WATCHTOWER_NOTIFICATION_EMAIL_FROM=your_email@example.com
    # - WATCHTOWER_NOTIFICATION_EMAIL_TO=your_email@example.com
    # - WATCHTOWER_NOTIFICATION_EMAIL_SERVER=smtp.example.com
    # - WATCHTOWER_NOTIFICATION_EMAIL_SERVER_PORT=587
    # - WATCHTOWER_NOTIFICATION_EMAIL_SERVER_USER=your_smtp_user
    # - WATCHTOWER_NOTIFICATION_EMAIL_SERVER_PASSWORD=your_smtp_password

